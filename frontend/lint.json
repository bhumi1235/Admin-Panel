[{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\eslint.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\App.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\api\\api.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\components\\FormInput.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\components\\GuardDetailsModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\components\\IncidentDetailModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\components\\IncidentModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\components\\Navbar.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\components\\ProfileModal.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\components\\ProtectedRoute.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\components\\Sidebar.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\components\\StatCard.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\components\\Table.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\config\\config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\context\\AuthContext.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'err' is defined but never used.","line":21,"column":26,"nodeType":"Identifier","messageId":"unusedVar","endLine":21,"endColumn":29},{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":52,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":52,"endColumn":21}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { createContext, useState, useContext, useEffect } from \"react\";\r\nimport axios from \"axios\";\r\nimport { API_BASE_URL } from \"../config/config\";\r\n\r\nconst AuthContext = createContext();\r\n\r\nexport const AuthProvider = ({ children }) => {\r\n    const [user, setUser] = useState(null);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    useEffect(() => {\r\n        const checkAuth = async () => {\r\n            const token = localStorage.getItem(\"token\");\r\n            if (token) {\r\n                try {\r\n                    const res = await axios.get(`${API_BASE_URL}/api/admin/profile`, {\r\n                        headers: { Authorization: `Bearer ${token}` }\r\n                    });\r\n                    // Extract userData from response\r\n                    setUser(res.data.userData || res.data);\r\n                } catch (err) {\r\n                    console.error(\"Session expired or invalid token\");\r\n                    localStorage.removeItem(\"token\");\r\n                    setUser(null);\r\n                }\r\n            }\r\n            setLoading(false);\r\n        };\r\n        checkAuth();\r\n    }, []);\r\n\r\n    const login = async (email, password) => {\r\n        const res = await axios.post(`${API_BASE_URL}/api/admin/login`, { email, password });\r\n        const { token, ...userData } = res.data;\r\n        localStorage.setItem(\"token\", token);\r\n        setUser(userData);\r\n        return userData;\r\n    };\r\n\r\n    const logout = () => {\r\n        localStorage.removeItem(\"token\");\r\n        setUser(null);\r\n    };\r\n\r\n    return (\r\n        <AuthContext.Provider value={{ user, setUser, login, logout, loading, isAuthenticated: !!user }}>\r\n            {children}\r\n        </AuthContext.Provider>\r\n    );\r\n};\r\n\r\nexport const useAuth = () => useContext(AuthContext);\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\context\\IncidentContext.jsx","messages":[{"ruleId":"react-refresh/only-export-components","severity":2,"message":"Fast refresh only works when a file only exports components. Use a new file to share constants or functions between components.","line":6,"column":14,"nodeType":"Identifier","messageId":"namedExport","endLine":6,"endColumn":26},{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`loadIncidents` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\n  18 |     // Load incidents on mount\n  19 |     useEffect(() => {\n> 20 |         loadIncidents();\n     |         ^^^^^^^^^^^^^ `loadIncidents` accessed before it is declared\n  21 |     }, []);\n  22 |\n  23 |     const loadIncidents = useCallback(() => {\n\n  21 |     }, []);\n  22 |\n> 23 |     const loadIncidents = useCallback(() => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 24 |         setLoading(true);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^\n> 25 |         incidentService.initializeSampleData();\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^\n> 26 |         const data = incidentService.getIncidents();\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^\n> 27 |         setIncidents(data);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^\n> 28 |         setLoading(false);\n     | ^^^^^^^^^^^^^^^^^^^^^^^^^\n> 29 |     }, []);\n     | ^^^^^^^^^^^^ `loadIncidents` is declared here\n  30 |\n  31 |     const createIncident = useCallback((incidentData) => {\n  32 |         const newIncident = incidentService.createIncident(incidentData);","line":20,"column":9,"nodeType":null,"endLine":20,"endColumn":22},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'loadIncidents'. Either include it or remove the dependency array.","line":21,"column":8,"nodeType":"ArrayExpression","endLine":21,"endColumn":10,"suggestions":[{"desc":"Update the dependencies array to be: [loadIncidents]","fix":{"range":[671,673],"text":"[loadIncidents]"}}]}],"suppressedMessages":[],"errorCount":2,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import React, { createContext, useContext, useState, useEffect, useCallback } from 'react';\r\nimport { incidentService } from '../services/incidentService';\r\n\r\nconst IncidentContext = createContext();\r\n\r\nexport const useIncidents = () => {\r\n    const context = useContext(IncidentContext);\r\n    if (!context) {\r\n        throw new Error('useIncidents must be used within IncidentProvider');\r\n    }\r\n    return context;\r\n};\r\n\r\nexport const IncidentProvider = ({ children }) => {\r\n    const [incidents, setIncidents] = useState([]);\r\n    const [loading, setLoading] = useState(true);\r\n\r\n    // Load incidents on mount\r\n    useEffect(() => {\r\n        loadIncidents();\r\n    }, []);\r\n\r\n    const loadIncidents = useCallback(() => {\r\n        setLoading(true);\r\n        incidentService.initializeSampleData();\r\n        const data = incidentService.getIncidents();\r\n        setIncidents(data);\r\n        setLoading(false);\r\n    }, []);\r\n\r\n    const createIncident = useCallback((incidentData) => {\r\n        const newIncident = incidentService.createIncident(incidentData);\r\n        setIncidents(prev => [newIncident, ...prev]);\r\n        return newIncident;\r\n    }, []);\r\n\r\n    const updateIncident = useCallback((id, updates) => {\r\n        const updated = incidentService.updateIncident(id, updates);\r\n        if (updated) {\r\n            setIncidents(prev => prev.map(inc => inc.id === id ? updated : inc));\r\n        }\r\n        return updated;\r\n    }, []);\r\n\r\n    const resolveIncident = useCallback((id, resolvedBy, resolutionNotes) => {\r\n        const resolved = incidentService.resolveIncident(id, resolvedBy, resolutionNotes);\r\n        if (resolved) {\r\n            setIncidents(prev => prev.map(inc => inc.id === id ? resolved : inc));\r\n        }\r\n        return resolved;\r\n    }, []);\r\n\r\n    const deleteIncident = useCallback((id) => {\r\n        incidentService.deleteIncident(id);\r\n        setIncidents(prev => prev.filter(inc => inc.id !== id));\r\n    }, []);\r\n\r\n    const getActiveIncidentsCount = useCallback(() => {\r\n        return incidents.filter(inc => inc.status === 'active').length;\r\n    }, [incidents]);\r\n\r\n    const getIncidentsByStatus = useCallback((status) => {\r\n        return incidents.filter(inc => inc.status === status);\r\n    }, [incidents]);\r\n\r\n    const value = {\r\n        incidents,\r\n        loading,\r\n        createIncident,\r\n        updateIncident,\r\n        resolveIncident,\r\n        deleteIncident,\r\n        getActiveIncidentsCount,\r\n        getIncidentsByStatus,\r\n        refreshIncidents: loadIncidents\r\n    };\r\n\r\n    return (\r\n        <IncidentContext.Provider value={value}>\r\n            {children}\r\n        </IncidentContext.Provider>\r\n    );\r\n};\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\main.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\pages\\AddDutyType.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\pages\\AddSupervisor.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\pages\\AllGuards.jsx","messages":[{"ruleId":"no-unused-vars","severity":2,"message":"'stats' is assigned a value but never used. Allowed unused vars must match /^[A-Z_]/u.","line":16,"column":12,"nodeType":"Identifier","messageId":"unusedVar","endLine":16,"endColumn":17,"suggestions":[{"messageId":"removeVar","data":{"varName":"stats"},"fix":{"range":[678,683],"text":""},"desc":"Remove unused variable 'stats'."}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport Sidebar from \"../components/Sidebar\";\r\nimport Navbar from \"../components/Navbar\";\r\nimport Table from \"../components/Table\";\r\nimport { Shield, UserCheck, Trash2, Download, ChevronDown, UserPlus } from \"lucide-react\";\r\nimport api from \"../api/api\";\r\nimport { exportToPDF, exportToExcel } from \"../utils/exportUtils\";\r\nimport \"../styles/global/layout.css\";\r\nimport \"../styles/shared/GuardTable.css\";\r\n\r\nfunction AllGuards() {\r\n    const navigate = useNavigate();\r\n    const [guards, setGuards] = useState([]);\r\n    const [supervisors, setSupervisors] = useState([]);\r\n    const [stats, setStats] = useState({\r\n        total: 0,\r\n        assigned: 0,\r\n        unassigned: 0\r\n    });\r\n    const [isDownloadOpen, setIsDownloadOpen] = useState(false);\r\n\r\n    useEffect(() => {\r\n        const fetchAllGuards = async () => {\r\n            try {\r\n                // guards\r\n                const guardsRes = await api.get(`/api/guards`);\r\n                const g = guardsRes.data.data;\r\n\r\n                const formattedGuards = g.map(guard => ({\r\n                    id: guard.id,\r\n                    name: guard.fullName,\r\n                    phone: guard.phone,\r\n                    assignedArea: guard.assignedArea,\r\n                    status: guard.status,\r\n                    supervisorId: guard.supervisorId\r\n                }));\r\n\r\n                setGuards(formattedGuards);\r\n\r\n                // supervisors\r\n                const supRes = await api.get(`/api/admin/supervisors`);\r\n                const s = supRes.data.data;\r\n\r\n                const formattedSup = s.map(sp => ({\r\n                    id: sp.id,\r\n                    fullName: sp.full_name\r\n                }));\r\n\r\n                setSupervisors(formattedSup);\r\n\r\n                // stats\r\n                const assigned = formattedGuards.filter(g => g.supervisorId).length;\r\n                setStats({\r\n                    total: formattedGuards.length,\r\n                    assigned: assigned,\r\n                    unassigned: formattedGuards.length - assigned\r\n                });\r\n\r\n            } catch (err) {\r\n                console.error(\"Failed to load guards:\", err);\r\n            }\r\n        };\r\n\r\n        fetchAllGuards();\r\n    }, [navigate]);\r\n\r\n\r\n\r\n\r\n    const getSupervisorName = (supervisorId) => {\r\n        const supervisor = supervisors.find(s => s.id === supervisorId);\r\n        return supervisor ? supervisor.fullName : 'Unassigned';\r\n    };\r\n\r\n    const handleGuardClick = (guard) => {\r\n        navigate(`/guards/${guard.id}`);\r\n    };\r\n\r\n    const columns = [\r\n        {\r\n            header: \"Guard Name\",\r\n            accessor: \"name\",\r\n            render: (row) => (\r\n                <div className=\"guard-name-cell\">\r\n                    <div className=\"guard-avatar\">\r\n                        {row.name.split(' ').map(n => n[0]).join('')}\r\n                    </div>\r\n                    <span className=\"guard-name-text\">\r\n                        {row.name}\r\n                    </span>\r\n                </div>\r\n            )\r\n        },\r\n        {\r\n            header: \"Phone Number\",\r\n            accessor: \"phone\",\r\n            render: (row) => (\r\n                <div className=\"guard-phone-cell\">\r\n                    {row.phone}\r\n                </div>\r\n            )\r\n        },\r\n        {\r\n            header: \"Assigned Area\",\r\n            accessor: \"assignedArea\",\r\n            render: (row) => (\r\n                <div className=\"area-badge\">\r\n                    <Shield size={15} strokeWidth={2.5} />\r\n                    {row.assignedArea}\r\n                </div>\r\n            )\r\n        },\r\n        {\r\n            header: \"Supervisor\",\r\n            accessor: \"supervisorId\",\r\n            render: (row) => {\r\n                const supervisorName = getSupervisorName(row.supervisorId);\r\n                return (\r\n                    <div className=\"supervisor-badge\">\r\n                        <UserCheck size={15} strokeWidth={2.5} />\r\n                        {supervisorName}\r\n                    </div>\r\n                );\r\n            }\r\n        },\r\n        {\r\n            header: \"Status\",\r\n            accessor: \"status\",\r\n            render: (row) => (\r\n                <span className={`status-label ${row.status === \"Active\" ? \"status-active\" : \"status-inactive\"}`}>\r\n                    <div className=\"status-dot\"></div>\r\n                    {row.status}\r\n                </span>\r\n            )\r\n        },\r\n        {\r\n            header: \"Actions\",\r\n            render: (row) => (\r\n                <button\r\n                    onClick={async (e) => {\r\n                        e.stopPropagation();\r\n                        if (window.confirm(`Are you sure you want to delete ${row.name}?`)) {\r\n                            try {\r\n                                await api.delete(`/api/guards/${row.id}`);\r\n                                // Refresh the list\r\n                                const guardsRes = await api.get(`/api/guards`);\r\n                                const updatedGuards = guardsRes.data.data.map(guard => ({\r\n                                    id: guard.id,\r\n                                    name: guard.fullName,\r\n                                    phone: guard.phone,\r\n                                    assignedArea: guard.assignedArea,\r\n                                    status: guard.status,\r\n                                    supervisorId: guard.supervisorId\r\n                                }));\r\n                                setGuards(updatedGuards);\r\n                            } catch (err) {\r\n                                console.error(\"Failed to delete guard:\", err);\r\n                                alert(\"Failed to delete guard. Please try again.\");\r\n                            }\r\n                        }\r\n                    }}\r\n                    className=\"btn-delete\"\r\n                >\r\n                    <Trash2 size={14} />\r\n                    Delete\r\n                </button>\r\n            )\r\n        }\r\n    ];\r\n\r\n    const handleDownload = async (format) => {\r\n        setIsDownloadOpen(false);\r\n        const fileName = `All_Guards_${new Date().toISOString().split('T')[0]}`;\r\n        const title = \"All Security Guards List\";\r\n\r\n        if (format === 'pdf') {\r\n            exportToPDF(title, columns, guards, fileName);\r\n        } else {\r\n            await exportToExcel(guards, fileName, columns);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <div className=\"page-container\">\r\n            <Sidebar />\r\n\r\n            <div className=\"page-main\">\r\n                <Navbar />\r\n\r\n                <div className=\"page-content\">\r\n                    {/* Header */}\r\n                    <div className=\"page-header\">\r\n                        <div>\r\n                            <h1 className=\"page-title\">\r\n                                All Security Guards\r\n                            </h1>\r\n                            <p className=\"page-subtitle\">\r\n                                View all guards with their assignment status\r\n                            </p>\r\n                        </div>\r\n                        <div style={{ display: \"flex\", gap: \"1rem\" }}>\r\n\r\n                            {/* Download Dropdown */}\r\n                            <div className=\"download-dropdown-container\">\r\n                                <button\r\n                                    onClick={() => setIsDownloadOpen(!isDownloadOpen)}\r\n                                    className=\"btn-download\"\r\n                                >\r\n                                    <Download size={18} />\r\n                                    Download as\r\n                                    <ChevronDown\r\n                                        size={14}\r\n                                        style={{ transform: isDownloadOpen ? 'rotate(180deg)' : 'none', transition: '0.2s' }}\r\n                                    />\r\n                                </button>\r\n\r\n                                {isDownloadOpen && (\r\n                                    <div className=\"dropdown-menu\">\r\n                                        <button\r\n                                            onClick={() => handleDownload('pdf')}\r\n                                            className=\"dropdown-item\"\r\n                                        >\r\n                                            PDF Document\r\n                                        </button>\r\n                                        <button\r\n                                            onClick={() => handleDownload('excel')}\r\n                                            className=\"dropdown-item\"\r\n                                        >\r\n                                            Excel Spreadsheet\r\n                                        </button>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n                    {/* Guards Table */}\r\n                    <Table\r\n                        columns={columns}\r\n                        data={guards}\r\n                        onRowClick={handleGuardClick}\r\n                        emptyMessage=\"No guards found in the system.\"\r\n                    />\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default AllGuards;\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\pages\\Dashboard.jsx","messages":[{"ruleId":"react-hooks/set-state-in-effect","severity":2,"message":"Error: Calling setState synchronously within an effect can trigger cascading renders\n\nEffects are intended to synchronize state between React and external systems such as manually updating the DOM, state management libraries, or other platform APIs. In general, the body of an effect should do one or both of the following:\n* Update external systems with the latest state from React.\n* Subscribe for updates from some external system, calling setState in a callback function when external state changes.\n\nCalling setState synchronously within an effect body causes cascading renders that can hurt performance, and is not recommended. (https://react.dev/learn/you-might-not-need-an-effect).\n\n  33 |\n  34 |     useEffect(() => {\n> 35 |         fetchDashboard();\n     |         ^^^^^^^^^^^^^^ Avoid calling setState() directly within an effect\n  36 |     }, []);\n  37 |\n  38 |","line":35,"column":9,"nodeType":null,"endLine":35,"endColumn":23}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport Sidebar from \"../components/Sidebar\";\r\nimport Navbar from \"../components/Navbar\";\r\nimport StatCard from \"../components/StatCard\";\r\nimport { Users, Shield, UserCheck, ShieldCheck } from \"lucide-react\";\r\nimport api from \"../api/api\";\r\nimport \"../styles/pages/Dashboard.css\";\r\n\r\nfunction Dashboard() {\r\n    const navigate = useNavigate();\r\n    const [stats, setStats] = useState({\r\n        totalSupervisors: 0,\r\n        activeSupervisors: 0,\r\n        totalGuards: 0,\r\n    });\r\n\r\n    const fetchDashboard = async () => {\r\n        try {\r\n            const res = await api.get(`/api/admin/dashboard`);\r\n\r\n            setStats({\r\n                totalSupervisors: res.data.totalSupervisors,\r\n                activeSupervisors: res.data.activeSupervisors,\r\n                totalGuards: res.data.totalGuards,\r\n            });\r\n\r\n        } catch (err) {\r\n            console.error(\"Failed to load dashboard:\", err);\r\n        }\r\n    };\r\n\r\n\r\n    useEffect(() => {\r\n        fetchDashboard();\r\n    }, []);\r\n\r\n\r\n\r\n    return (\r\n        <div className=\"dashboard-container\">\r\n            <Sidebar />\r\n\r\n            <div className=\"dashboard-main\">\r\n                <Navbar />\r\n\r\n                <div className=\"dashboard-content\">\r\n                    {/* Welcome Section */}\r\n                    <div className=\"welcome-header\">\r\n                        <h1>\r\n                            Welcome back, {localStorage.getItem('adminName') || 'Admin'}!\r\n                        </h1>\r\n                        <p>\r\n                            Here's what's happening with your security team today.\r\n                        </p>\r\n                    </div>\r\n\r\n                    {/* Stats Grid */}\r\n                    <div className=\"stats-grid\">\r\n                        <StatCard\r\n                            icon={Users}\r\n                            title=\"Total Supervisors\"\r\n                            value={stats.totalSupervisors}\r\n                            color=\"primary\"\r\n                            onClick={() => navigate('/supervisors?status=Active')}\r\n                        />\r\n                        <StatCard\r\n                            icon={UserCheck}\r\n                            title=\"Active Supervisors\"\r\n                            value={stats.activeSupervisors}\r\n                            color=\"success\"\r\n                            onClick={() => navigate('/supervisors?status=Active')}\r\n                        />\r\n                        <StatCard\r\n                            icon={Shield}\r\n                            title=\"Total Guards\"\r\n                            value={stats.totalGuards}\r\n                            color=\"secondary\"\r\n                            onClick={() => navigate('/all-guards')}\r\n                        />\r\n\r\n                    </div>\r\n\r\n                    {/* Quick Actions */}\r\n                    <div className=\"quick-actions-card\">\r\n                        <h3>Quick Actions</h3>\r\n                        <div className=\"actions-group\">\r\n                            <button\r\n                                onClick={() => navigate('/supervisors/add')}\r\n                                className=\"btn-add-supervisor\"\r\n                            >\r\n                                Add New Supervisor\r\n                            </button>\r\n                            <button\r\n                                onClick={() => navigate('/supervisors')}\r\n                                className=\"btn-view-all\"\r\n                            >\r\n                                View All Supervisors\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Dashboard;\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\pages\\DutyTypes.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\pages\\EditDutyType.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\pages\\GuardDetails.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\pages\\Guards.jsx","messages":[{"ruleId":"react-hooks/immutability","severity":2,"message":"Error: Cannot access variable before it is declared\n\n`fetchSupervisorAndGuards` is accessed before it is declared, which prevents the earlier access from updating when this value changes over time.\n\n  20 |\n  21 |     useEffect(() => {\n> 22 |         fetchSupervisorAndGuards();\n     |         ^^^^^^^^^^^^^^^^^^^^^^^^ `fetchSupervisorAndGuards` accessed before it is declared\n  23 |     }, [id, navigate]);\n  24 |\n  25 |     const fetchSupervisorAndGuards = async () => {\n\n  23 |     }, [id, navigate]);\n  24 |\n> 25 |     const fetchSupervisorAndGuards = async () => {\n     |     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n> 26 |         try {\n     | ^^^^^^^^^^^^^\n> 27 |             // supervisor details\n     â€¦\n     | ^^^^^^^^^^^^^\n> 55 |         }\n     | ^^^^^^^^^^^^^\n> 56 |     };\n     | ^^^^^^^ `fetchSupervisorAndGuards` is declared here\n  57 |\n  58 |\n  59 |     const columns = [","line":22,"column":9,"nodeType":null,"endLine":22,"endColumn":33},{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'fetchSupervisorAndGuards'. Either include it or remove the dependency array.","line":23,"column":8,"nodeType":"ArrayExpression","endLine":23,"endColumn":22,"suggestions":[{"desc":"Update the dependencies array to be: [fetchSupervisorAndGuards, id, navigate]","fix":{"range":[865,879],"text":"[fetchSupervisorAndGuards, id, navigate]"}}]}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect, useState } from \"react\";\r\nimport { useNavigate, useParams } from \"react-router-dom\";\r\nimport Sidebar from \"../components/Sidebar\";\r\nimport Navbar from \"../components/Navbar\";\r\nimport Table from \"../components/Table\";\r\nimport { ArrowLeft, Shield, Download, ChevronDown } from \"lucide-react\";\r\nimport api from \"../api/api\";\r\nimport { exportToPDF, exportToExcel } from \"../utils/exportUtils\";\r\nimport \"../styles/global/layout.css\";\r\nimport \"../styles/shared/GuardTable.css\";\r\nimport \"../styles/pages/Guards.css\";\r\n\r\n\r\nfunction Guards() {\r\n    const navigate = useNavigate();\r\n    const { id } = useParams();\r\n    const [supervisor, setSupervisor] = useState(null);\r\n    const [guards, setGuards] = useState([]);\r\n    const [isDownloadOpen, setIsDownloadOpen] = useState(false);\r\n\r\n    useEffect(() => {\r\n        fetchSupervisorAndGuards();\r\n    }, [id, navigate]);\r\n\r\n    const fetchSupervisorAndGuards = async () => {\r\n        try {\r\n            // supervisor details\r\n            const supRes = await api.get(`/api/admin/supervisors/${id}`);\r\n\r\n            const sup = supRes.data.data;\r\n            setSupervisor({\r\n                id: sup.id,\r\n                fullName: sup.full_name,\r\n                email: sup.email,\r\n                phone: sup.phone,\r\n                status: sup.status\r\n            });\r\n\r\n            // guards under this supervisor\r\n            const guardRes = await api.get(`/api/admin/supervisors/${id}/guards`);\r\n\r\n            const formattedGuards = guardRes.data.data.map(g => ({\r\n                id: g.id,\r\n                name: g.fullName,\r\n                phone: g.phone,\r\n                assignedArea: g.assignedArea,\r\n                status: g.status\r\n            }));\r\n\r\n            setGuards(formattedGuards);\r\n\r\n        } catch (err) {\r\n            console.error(\"Failed to load supervisor/guards:\", err);\r\n            setSupervisor({ fullName: \"Error loading data\" }); // Fallback\r\n        }\r\n    };\r\n\r\n\r\n    const columns = [\r\n        {\r\n            header: \"Guard Name\",\r\n            accessor: \"name\",\r\n            render: (row) => (\r\n                <div className=\"guard-name-cell\">\r\n                    <div className=\"guard-avatar\">\r\n                        {row.name.split(' ').map(n => n[0]).join('')}\r\n                    </div>\r\n                    <span className=\"guard-name-text\">\r\n                        {row.name}\r\n                    </span>\r\n                </div>\r\n            )\r\n        },\r\n        {\r\n            header: \"Phone Number\",\r\n            accessor: \"phone\",\r\n            render: (row) => (\r\n                <div className=\"guard-phone-cell\">\r\n                    {row.phone}\r\n                </div>\r\n            )\r\n        },\r\n        {\r\n            header: \"Assigned Area\",\r\n            accessor: \"assignedArea\",\r\n            render: (row) => (\r\n                <div className=\"area-badge\">\r\n                    <Shield size={15} strokeWidth={2.5} />\r\n                    {row.assignedArea}\r\n                </div>\r\n            )\r\n        },\r\n        {\r\n            header: \"Status\",\r\n            accessor: \"status\",\r\n            render: (row) => (\r\n                <span className={`status-label ${row.status === \"Active\" ? \"status-active\" : \"status-inactive\"}`}>\r\n                    <div className=\"status-dot\"></div>\r\n                    {row.status}\r\n                </span>\r\n            )\r\n        },\r\n        {\r\n            header: \"Actions\",\r\n            render: (row) => (\r\n                <button\r\n                    onClick={async (e) => {\r\n                        e.stopPropagation();\r\n                        try {\r\n                            const newStatus = row.status === \"Active\" ? \"Inactive\" : \"Active\";\r\n                            await api.put(`/api/guards/${row.id}/status`, {\r\n                                status: newStatus\r\n                            });\r\n\r\n                            // Update local state\r\n                            setGuards(guards.map(g =>\r\n                                g.id === row.id ? { ...g, status: newStatus } : g\r\n                            ));\r\n                        } catch (err) {\r\n                            console.error(\"Failed to update status:\", err);\r\n                            alert(\"Failed to update status\");\r\n                        }\r\n                    }}\r\n                    className={`btn-status-toggle ${row.status === \"Active\" ? \"deactivate\" : \"activate\"}`}\r\n                >\r\n                    {row.status === \"Active\" ? \"Deactivate\" : \"Activate\"}\r\n                </button>\r\n            )\r\n        }\r\n    ];\r\n\r\n    const handleDownload = async (format) => {\r\n        setIsDownloadOpen(false);\r\n        const fileName = `${supervisor.fullName}_Guards_${new Date().toISOString().split('T')[0]}`;\r\n        const title = `Security Guards assigned to ${supervisor.fullName}`;\r\n\r\n        if (format === 'pdf') {\r\n            exportToPDF(title, columns, guards, fileName);\r\n        } else {\r\n            await exportToExcel(guards, fileName, columns);\r\n        }\r\n    };\r\n\r\n    if (!supervisor) {\r\n        return (\r\n            <div className=\"page-container\">\r\n                <Sidebar />\r\n                <div className=\"page-main\">\r\n                    <Navbar />\r\n                    <div className=\"page-content\" style={{ textAlign: \"center\" }}>\r\n                        <p>Loading...</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        );\r\n    }\r\n\r\n    return (\r\n        <div className=\"page-container\">\r\n            <Sidebar />\r\n\r\n            <div className=\"page-main\">\r\n                <Navbar />\r\n\r\n                <div className=\"page-content\">\r\n                    {/* Header */}\r\n                    <div className=\"header-wrapper\">\r\n                        <button\r\n                            onClick={() => navigate(`/supervisors/${id}`)}\r\n                            className=\"btn-back\"\r\n                        >\r\n                            <ArrowLeft size={16} />\r\n                            Back to Supervisor Details\r\n                        </button>\r\n\r\n                        <div className=\"page-header\">\r\n                            <div>\r\n                                <h1 className=\"page-title\">\r\n                                    Security Guards\r\n                                </h1>\r\n                                <p className=\"page-subtitle\">\r\n                                    Guards assigned to <strong>{supervisor.fullName}</strong>\r\n                                </p>\r\n                            </div>\r\n\r\n                            {/* Download Dropdown */}\r\n                            <div className=\"download-dropdown-container\">\r\n                                <button\r\n                                    onClick={() => setIsDownloadOpen(!isDownloadOpen)}\r\n                                    className=\"btn-download\"\r\n                                >\r\n                                    <Download size={18} />\r\n                                    Download as\r\n                                    <ChevronDown\r\n                                        size={14}\r\n                                        style={{ transform: isDownloadOpen ? 'rotate(180deg)' : 'none', transition: '0.2s' }}\r\n                                    />\r\n                                </button>\r\n\r\n                                {isDownloadOpen && (\r\n                                    <div className=\"dropdown-menu\">\r\n                                        <button\r\n                                            onClick={() => handleDownload('pdf')}\r\n                                            className=\"dropdown-item\"\r\n                                        >\r\n                                            PDF Document\r\n                                        </button>\r\n                                        <button\r\n                                            onClick={() => handleDownload('excel')}\r\n                                            className=\"dropdown-item\"\r\n                                        >\r\n                                            Excel Spreadsheet\r\n                                        </button>\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Stats Banner */}\r\n                    <div className=\"stats-banner\">\r\n                        <div className=\"stats-banner-text\">\r\n                            <p>Total Guards Assigned</p>\r\n                            <p>{guards.length}</p>\r\n                        </div>\r\n                        <div className=\"stats-banner-icon\">\r\n                            <Shield size={32} />\r\n                        </div>\r\n                    </div>\r\n\r\n                    {/* Guards Table */}\r\n                    <Table\r\n                        columns={columns}\r\n                        data={guards}\r\n                        onRowClick={(row) => navigate(`/guards/${row.id}`, { state: { fromSupervisorId: id } })}\r\n                        emptyMessage={`No guards assigned to ${supervisor.fullName} yet.`}\r\n                    />\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Guards;\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\pages\\Incidents.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\pages\\Login.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\pages\\ResetData.jsx","messages":[{"ruleId":"react-hooks/exhaustive-deps","severity":1,"message":"React Hook useEffect has a missing dependency: 'logout'. Either include it or remove the dependency array.","line":32,"column":8,"nodeType":"ArrayExpression","endLine":32,"endColumn":18,"suggestions":[{"desc":"Update the dependencies array to be: [logout, navigate]","fix":{"range":[1022,1032],"text":"[logout, navigate]"}}]}],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":1,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { useEffect } from \"react\";\r\nimport { useNavigate } from \"react-router-dom\";\r\nimport { useAuth } from \"../context/AuthContext\";\r\nimport api from \"../api/api\";\r\n\r\nfunction ResetData() {\r\n    const navigate = useNavigate();\r\n    const { logout } = useAuth();\r\n\r\n    useEffect(() => {\r\n        const resetDatabase = async () => {\r\n            try {\r\n                // Clear authentication\r\n                logout();\r\n\r\n                // Call backend API to reset database\r\n                await api.post(`/api/reset-database`);\r\n\r\n                // Redirect to login after reset\r\n                setTimeout(() => {\r\n                    alert('Database has been reset! Please login again.');\r\n                    navigate('/');\r\n                }, 1000);\r\n            } catch (err) {\r\n                console.error(\"Failed to reset database:\", err);\r\n                alert('Failed to reset database. Please try again.');\r\n                navigate('/');\r\n            }\r\n        };\r\n\r\n        resetDatabase();\r\n    }, [navigate]);\r\n\r\n    return (\r\n        <div style={{\r\n            minHeight: \"100vh\",\r\n            display: \"flex\",\r\n            alignItems: \"center\",\r\n            justifyContent: \"center\",\r\n            background: \"linear-gradient(135deg, #667eea 0%, #764ba2 100%)\",\r\n            color: \"white\",\r\n            fontSize: \"1.5rem\",\r\n            fontWeight: \"600\"\r\n        }}>\r\n            Resetting database...\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default ResetData;\r\n\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\pages\\SupervisorDetails.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\pages\\Supervisors.jsx","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\routes\\AppRoutes.jsx","messages":[{"ruleId":null,"nodeType":null,"fatal":true,"severity":2,"message":"Parsing error: Identifier 'ProtectedRoute' has already been declared","line":15,"column":8}],"suppressedMessages":[],"errorCount":1,"fatalErrorCount":1,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"source":"import { Routes, Route } from \"react-router-dom\";\r\nimport Login from \"../pages/Login\";\r\nimport Dashboard from \"../pages/Dashboard\";\r\nimport Supervisors from \"../pages/Supervisors\";\r\nimport AddSupervisor from \"../pages/AddSupervisor\";\r\nimport SupervisorDetails from \"../pages/SupervisorDetails\";\r\nimport Guards from \"../pages/Guards\";\r\nimport AllGuards from \"../pages/AllGuards\";\r\nimport GuardDetails from \"../pages/GuardDetails\";\r\nimport ResetData from \"../pages/ResetData\";\r\nimport ProtectedRoute from \"../components/ProtectedRoute\";\r\nimport DutyTypes from \"../pages/DutyTypes\";\r\nimport AddDutyType from \"../pages/AddDutyType\";\r\nimport EditDutyType from \"../pages/EditDutyType\";\r\nimport ProtectedRoute from \"../components/ProtectedRoute\";\r\n\r\nfunction AppRoutes() {\r\n    return (\r\n        <Routes>\r\n            <Route path=\"/\" element={<Login />} />\r\n\r\n            {/* Protected Routes */}\r\n            <Route element={<ProtectedRoute />}>\r\n                <Route path=\"/dashboard\" element={<Dashboard />} />\r\n                <Route path=\"/supervisors\" element={<Supervisors />} />\r\n                <Route path=\"/supervisors/add\" element={<AddSupervisor />} />\r\n                <Route path=\"/supervisors/:id\" element={<SupervisorDetails />} />\r\n                <Route path=\"/supervisors/:id/guards\" element={<Guards />} />\r\n                <Route path=\"/guards\" element={<AllGuards />} />\r\n                <Route path=\"/guards/:id\" element={<GuardDetails />} />\r\n                <Route path=\"/all-guards\" element={<AllGuards />} />\r\n\r\n                {/* Duty Types Routes */}\r\n                <Route path=\"/duty-types\" element={<DutyTypes />} />\r\n                <Route path=\"/duty-types/add\" element={<AddDutyType />} />\r\n                <Route path=\"/duty-types/edit/:id\" element={<EditDutyType />} />\r\n            </Route>\r\n\r\n            <Route path=\"/reset\" element={<ResetData />} />\r\n        </Routes>\r\n    );\r\n}\r\n\r\nexport default AppRoutes;\r\n","usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\services\\incidentService.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\src\\utils\\exportUtils.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]},{"filePath":"C:\\Users\\91917\\OneDrive\\Desktop\\Security-Guard-Admin\\frontend\\vite.config.js","messages":[],"suppressedMessages":[],"errorCount":0,"fatalErrorCount":0,"warningCount":0,"fixableErrorCount":0,"fixableWarningCount":0,"usedDeprecatedRules":[]}]